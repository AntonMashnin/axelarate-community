---
id: e1
sidebar_position: 1
sidebar_label: Упражнение 1
slug: /упражнение/e1
---
# Упражнение 1
Переведите BTC в Ethereum (как обёрнутый актив) и обратно с помощью интерфейса командной строки Axelar Network.

## Уровень
Средний

## Отказ от ответственности
:::предупреждение
Axelar Network находится в стадии разработки. Ни в коем случае нельзя передавать какие-либо реальные активы с помощью Axelar. Используйте только те токены тестовой сети, которые Вы не боитесь потерять. Axelar не несет ответственности за потерянные активы, или их заморозку или за токены которые не подлежат восстановлению в любом состоянии. Если Вы обнаружите проблему,пожалуйста, сообщите о проблеме в этом репозитории, следуя шаблону.
:::

## Предварительные требования
- Выполните все шаги из этого руководства [Установка при помощи Docker(a)](/setup-docker) или [Установка из исходного кода](/setup-binaries)
- Установите кошелек Ethereum с использованием [MEW](https://www.myetherwallet.com/) и получите адрес Ethereum кошелька, который будет финансироваться за счет эфириума (Вы также можете использовать [Chrome плагин](https://chrome.google.com/webstore/detail/mew-cx/nlbmnnijcnlegkjjpcfjclmcfggfefdm?hl=en))

## Полезные ссылки
- [Axelar Кран](http://faucet.testnet.axelar.dev/)
- Последняя версия Docker образа:
  + https://hub.docker.com/repository/docker/axelarnet/axelar-core
  + https://hub.docker.com/repository/docker/axelarnet/tofnd
- Упражнение 1 [видео с пошаговым руководством](https://youtu.be/QC7Gx-ydTtw) как использовать Docker 
  + Для выполнения задания использовалась версия Axelar v0.7.6, будьте осторожны с потенциальными различиями в рабочем процессе
- [Дополнительные команды](/extra-commands) для получения состояния сети Axelar

## Что Вам понадобиться
- Биткойн кран тестовой сети для отправки тестовых BTC:: https://testnet-faucet.mempool.co/
- Metamask
- Ethereum Ropsten адрес (сгенерированный в Metamask)


## Присоединитесь к тестовой сети Axelar

Используйте руководство для [настройки среды с помощью Docker](/setup-docker) или [настройки из исходного кода](/setup-binaries) чтобы убедиться, что Ваш серве обновлен, и Вы получили несколько тестовых монет на свою учетную запись валидатора.

## Инструкция создания и сжигание монет
Эти инструкции представляют собой пошаговое руководство выполнения команд для перемещения актива из исходного места в сеть назначения и обратно. Активы создаются как завернутые активы ERC-20 в цепочке назначения. Команды отправляются в сеть Axelar Network, которая отвечает за (а) создания адресов ввода/вывода, (b) маршрутизацию и завершение транзакций, и (c) создание/сжигание соответствующих активов.

Для выполнения этих тестов Вам понадобятся несколько тестовых биткойнов в тестовой сети Биткойн, и адрес получателя Ethereum в тестовой сети Ethereum Ropsten.

### Создание ERC20 Bitcoin монет на Ethereum
  
1. Создайте адрес депозита в биткойнах (на который, позже, Вы выполните отправку монет)

```bash
axelard tx bitcoin link ethereum {ethereum Ropsten dst addr} --from validator
-> returns bitcoin deposit address
```

т.е.,

```bash
axelard tx bitcoin link ethereum 0xc1c0c8D2131cC866834C6382096EaDFEf1af2F52 --from validator
```

После этого Вы должны увидеть `successfully linked {bitcoin deposit address} and {ethereum Ropsten dst addr}`

2. Внешний: отправьте несколько ТЕСТОВЫХ BTC в тестовой сети Биткойн на адрес биткоин депозита, указанный выше, и дождитесь 6 подтверждений (в биткойн сети).
- ВНИМАНИЕ: НЕ ОТПРАВЛЯЙТЕ РЕАЛЬНЫЕ АКТИВЫ
- Вы можете использовать биткойн кран, например https://bitcoinfaucet.uo1.net/ отправить ТЕСТОВЫЙ BTC на адрес депозита
- Вы можете следить за состоянием своего депозита с помощью проводника в тестовой сети: https://blockstream.info/testnet/


3. Подтвердите получение биткойна

```bash
axelard tx bitcoin confirm-tx-out "{txID:vout}" "{amount}btc" "{deposit address}" --from validator
```

т.е.,

```bash
axelard tx bitcoin confirm-tx-out 615df0b4d5053630d24bdd7661a13bea28af8bc1eb0e10068d39b4f4f9b6082d:0 0.00088btc tb1qlteveekr7u2qf8faa22gkde37epngsx9d7vgk98ujtzw77c27k7qk2qvup --from validator
```

Дождитесь подтверждения транзакции (~10 Axelar блоков, ~50 secs).
В конце концов, вы увидите что-то вроде этого в консоли сервера:

```bash
bitcoin outpoint confirmation result is
```

Вы можете выполнить поиск с помощью `docker logs -f axelar-core 2>&1 | grep -a -e outpoint`.

4. Подпись перевода в сеть Ethereum. Сначала создайте переводы которые находяться в ожидании, а затем подпишите их:

```bash
axelard tx evm create-pending-transfers ethereum --from validator --gas auto --gas-adjustment 1.2 && axelard tx evm sign-commands ethereum --from validator --gas auto --gas-adjustment 1.2
```
Вы должны увидеть `successfully started signing batched commands with ID {batched commands ID}` and wait for sign protocol to complete (~10 Axelar blocks).

5. Получите вывод команды, которая должна быть отправлена для создания Ethereum транзакции

```bash
axelard q evm batched-commands ethereum {batched commands ID from step 4}
```
Найдите вывод команды, в разделе `execute_data`. Скопируйте и сохраните его для использования на следующем шаге.

6. Отправьте транзакцию Ethereum, обернув данные:

Откройте свой кошелек Metamask, зайдите в Настройки -> Дополнительно, затем найдите Показать данные HEX и включите эту опцию. Таким образом, вы можете отправить транзакцию с данными напрямую через кошелек Metamask. Помните, чтобы не передавать токены, вам просто нужно ввести данные из приведенного выше `execute_data` и отправить её используя шлюз смарт-контракта (см. [версию тестовой сети](/testnet-releases)). При этом убедитесь, что цена на газ в Metamask обновляется после того как Вы ввели данные.

В качестве альтернативы Вы можете открыть свой MEW кошелек, и перейти на страницу "Отправить транзакцию", с расширенными параметрами. Теперь Вам необходимо отправить транзакцию в смарт-контракт при помощи шлюза со значением Ether **0**, а поле данных - это данные команды, полученные на предыдущем шаге. Ваш экран должен выглядеть примерно так, как показано ниже, и Вы можете просто отправить транзакцию на выполнение и создать свои токены.

![](https://user-images.githubusercontent.com/1995809/118490096-2753c480-b750-11eb-9c9d-5eb478194ae4.png)

(Обратите внимание, что "To Address" - это адрес смарт-контракта Axelar шлюза., который вы можете найти здесь [Версия Testnet](/testnet-releases), а поле "Добавить данные" - это данные команды, которые D\Вы получили на предыдущем шаге)

Теперь вы можете открыть Metamask, выбрать "Активы", затем "Добавить токен", затем "Пользовательский токен", после чего вставить адрес контракта токена. (см. [Версию Testnet](/testnet-releases) и найдите поле `С адресом контракта токена в сети Ethereum`).

### Сжечь обернутые биткойн-токены ERC20 и получите родные сатоши

Чтобы конвертировать обёрнутый биткойн обратно в биткойн, выполните следующие команды:

1. Создайте Ethereum депозит адрес

```bash
axelard tx evm link ethereum bitcoin {destination bitcoin addr} satoshi --from validator
```

т.е.,
```bash
axelard tx evm link ethereum bitcoin tb1qg2z5jatp22zg7wyhpthhgwvn0un05mdwmqgjln satoshi --from validator
```

Найдите адрес депозита Ethereum в качестве первой строчки вывода в этой строке (`0x5CFE...`):

```bash
"successfully linked {0x5CFEcE3b659e657E02e31d864ef0adE028a42a8E} and {tb1qq8wnre6rzctec9wycrl2dq00m3avravslahc8v}"
```
:::обратите внимание
Убедитесь, что вы связали биткойн-адрес, который контролируется Вами, т.е. если Вы свяжете его с адресом, контролируемым Axelar, Ваш вывод будет считаться пожертвованием и добавлен в пул средств
:::

2. Внешний: отправить завернутые токены на адрес депозита (например, с помощью Metamask). Для отправки транзакций на Вашем кошельке должен быть тестовой эфириум в сети Ropsten. Подождите 30 подтверждений блока Ethereum. Вы можете следить за состоянием своего депозита с помощью проводника тестовой сети: https://ropsten.etherscan.io/

3.Подтвердите Ethereum транзакцию 

```bash
axelard tx evm confirm-erc20-deposit ethereum {txID} {amount} {deposit addr} --from validator
```

Здесь количество должно быть указано в сатошах. (Например, 0.0001BTC = 10000)
т.е.,

```bash
axelard tx evm confirm-erc20-deposit ethereum 0x01b00d7ed8f66d558e749daf377ca30ed45f747bbf64f2fd268a6d1ea84f916a 10000 0x5CFEcE3b659e657E02e31d864ef0adE028a42a8E --from validator
```
Убедитесь, что подтверждение транзакции Ethereum депозита прошло успешно.

```bash
axelard q evm deposit-state ethereum {txID} {deposit addr} {amount}
```

т.е.,

```bash
axelard q evm deposit-state ethereum 0xa959623013b5355de5f023fb3044dae02bf915d57b9440460ca59a98663741a8 0x7c5578F5cC4c9253F1E5495240785DD477843D80 10000
```
Вы должны увидеть `deposit transaction is confirmed`.

:::подсказка
В этом релизе, мы запускаем эти команды примерно раз в день. Так что вернитесь через 24 часа и проверьте баланс на адресе тестовой сети Биткойн, на который Вы отправили вывод средств.
:::
